# BGP peerings with site gateways
{% for peer in site_l3.peers %}
  {% set host = hostvars[peer] %}
protocol bgp 'wg_peer_{{ site.code }}_{{ peer }}' from 'wg_peer_{{ site.code }}' {
{% if host.interface.wireguard.address.ipv6 | ipaddr('fe80::/10') %}
  neighbor {{ host.interface.wireguard.address.ipv6 | strip_prefixlen }}%'wg-{{ site.code }}' as {{ site.bgp.as }};
{% else %}
  neighbor {{ host.interface.wireguard.address.ipv6 | strip_prefixlen }} as {{ site.bgp.as }};
{% endif %}
};

{% endfor %}
